# AGENTS.md - é¦™å…¸å¸³ã‚¢ãƒ—ãƒªé–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯é¦™å…¸å¸³ç®¡ç†ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚Next.js + TypeScript + Supabase + Tailwind CSS + shadcn/uiã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

## åŸºæœ¬åŽŸå‰‡

### ðŸš« çµ¶å¯¾ã«å®ˆã‚‹ã¹ããƒ«ãƒ¼ãƒ«

1. **TypeScriptã®`any`åž‹ã¯çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢**
   - åž‹å®‰å…¨æ€§ã‚’æãªã†`any`ã¯ä¸€åˆ‡ä½¿ç”¨ã—ãªã„
   - ä¸æ˜Žãªåž‹ã¯`unknown`ã‚’ä½¿ç”¨ã—ã€é©åˆ‡ãªåž‹ã‚¬ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹
   - å¤–éƒ¨APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚‚å¿…ãšåž‹å®šç¾©ã‚’è¡Œã†

2. **ãã®å ´ã—ã®ãŽã®å®Ÿè£…ç¦æ­¢**
   - æ ¹æœ¬çš„ãªå•é¡Œè§£æ±ºã‚’å„ªå…ˆã™ã‚‹
   - å°†æ¥çš„ãªæ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆã‚’è¡Œã†
   - æŠ€è¡“çš„è² å‚µã‚’è“„ç©ã•ã›ãªã„

3. **æ—¥æœ¬èªžãƒ†ã‚­ã‚¹ãƒˆã®å¾¹åº•**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã¯æ—¥æœ¬èªžã§è¨˜è¿°
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ©ãƒ™ãƒ«ã€ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ãªã©å…¨ã¦å«ã‚€
   - æ—¥æœ¬ã®æ…£ç¿’ã«åˆã‚ã›ãŸä¸å¯§èªžã‚’ä½¿ç”¨

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Next.js 15** (App Router)
- **TypeScript+**
- **React 19** (Server Components & Client Componentsé©åˆ‡ã«ä½¿ã„åˆ†ã‘)
- **Tailwind CSS v4** (ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°)
- **shadcn/ui** (UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **Supabase** (èªè¨¼ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½)
- **PostgreSQL** (ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)
- **Row Level Security (RLS)** (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
- **Bun** (ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼)

### çŠ¶æ…‹ç®¡ç†ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°
- **Jotai** (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†)
- **Supabase Client** (ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°)
- **React Query/TanStack Query** (ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ç®¡ç†)

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦å‰‡

### åž‹å®šç¾©ãƒ»TypeScript

```typescript
// âŒ æ‚ªã„ä¾‹
function processData(data: any) {
  return data.someProperty;
}

// âœ… è‰¯ã„ä¾‹
interface UserData {
  id: string;
  name: string;
  email: string;
}

function processData(data: UserData): string {
  return data.name;
}
```

- **ã™ã¹ã¦ã®é–¢æ•°ã«åž‹æ³¨é‡ˆã‚’å¿…é ˆã¨ã™ã‚‹**
- **interfaceã¨typeã®ä½¿ã„åˆ†ã‘ã‚’æ˜Žç¢ºã«ã™ã‚‹**
  - æ‹¡å¼µå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåž‹: `interface`
  - Unionåž‹ã€è¨ˆç®—åž‹: `type`
- **Genericsã‚’ç©æ¥µçš„ã«æ´»ç”¨ã™ã‚‹**
- **null/undefinedã®æ‰±ã„ã‚’æ˜Žç¢ºã«ã™ã‚‹**

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

```typescript
// âœ… è‰¯ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾‹
interface KoudenEntryProps {
  entry: KoudenEntry;
  onUpdate: (entry: KoudenEntry) => Promise<void>;
  isEditable?: boolean;
}

export const KoudenEntryCard: React.FC<KoudenEntryProps> = ({
  entry,
  onUpdate,
  isEditable = false
}) => {
  // å®Ÿè£…
};
```

- **Propsåž‹ã‚’å¿…ãšå®šç¾©ã™ã‚‹**
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯åž‹å®šç¾©å†…ã§æ˜Žè¨˜ã™ã‚‹**
- **å˜ä¸€è²¬ä»»ã®åŽŸå‰‡ã‚’å®ˆã‚‹**
- **Server Componentsã¨Client Componentsã‚’é©åˆ‡ã«ä½¿ã„åˆ†ã‘ã‚‹**

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// âœ… é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
async function createKoudenEntry(data: CreateKoudenEntryInput) {
  try {
    const { data: entry, error } = await supabase
      .from('kouden_entries')
      .insert(data)
      .select()
      .single();

    if (error) {
      throw new Error(`è¨˜å¸³ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
    }

    return { success: true, data: entry };
  } catch (error) {
    console.error('è¨˜å¸³ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
    return { 
      success: false, 
      error: error instanceof Error ? error.message : 'ä¸æ˜Žãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'
    };
  }
}
```

- **ã™ã¹ã¦ã®éžåŒæœŸå‡¦ç†ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…**
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æä¾›**
- **Supabaseã‚¨ãƒ©ãƒ¼ã‚’é©åˆ‡ã«ã‚­ãƒ£ãƒƒãƒãƒ»å¤‰æ›ã™ã‚‹**

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æœ€é©åŒ–

- **React.memoã€useMemoã€useCallbackã‚’é©åˆ‡ã«ä½¿ç”¨**
- **ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é˜²ã**
- **ç”»åƒã®æœ€é©åŒ–ï¼ˆnext/imageä½¿ç”¨ï¼‰**
- **Suspenseã¨ãƒ­ã‚±ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ´»ç”¨**

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **Row Level Security (RLS) ã‚’å¿…ãšæœ‰åŠ¹ã«ã™ã‚‹**
- **SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã‚’å¾¹åº•**
- **é©åˆ‡ãªèªå¯ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…**
- **ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–**

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆãƒ»å‘½åè¦å‰‡

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 
```
src/
â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”œâ”€â”€ (public)/       # èªè¨¼ä¸è¦ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ (protected)/    # èªè¨¼å¿…è¦ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ (system)/       # ç®¡ç†è€…å°‚ç”¨ãƒšãƒ¼ã‚¸
â”œâ”€â”€ components/         # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ hooks/             # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”œâ”€â”€ lib/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»è¨­å®š
â”œâ”€â”€ stores/            # Zustand stores
â”œâ”€â”€ types/             # åž‹å®šç¾©
â””â”€â”€ utils/             # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
```

### å‘½åè¦å‰‡
- **ãƒ•ã‚¡ã‚¤ãƒ«å**: kebab-case (`kouden-entry-form.tsx`)
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå**: PascalCase (`KoudenEntryForm`)
- **é–¢æ•°å**: camelCase (`createKoudenEntry`)
- **å®šæ•°**: SCREAMING_SNAKE_CASE (`MAX_ENTRY_COUNT`)
- **åž‹å**: PascalCase (`KoudenEntry`)

## ç‰¹å®šãƒ‰ãƒ¡ã‚¤ãƒ³è¦å‰‡ï¼ˆé¦™å…¸å¸³ã‚¢ãƒ—ãƒªï¼‰

### é‡‘é¡ã®æ‰±ã„
```typescript
// âœ… é‡‘é¡ã¯å¿…ãšnumberåž‹ã§çµ±ä¸€
interface KoudenEntry {
  amount: number; // å††å˜ä½
  created_at: string;
  guest_name: string;
}

// è¡¨ç¤ºæ™‚ã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ
const formatCurrency = (amount: number): string => {
  return `Â¥${amount.toLocaleString('ja-JP')}`;
};
```

### æ—¥æœ¬ã®æ…£ç¿’ã¸ã®å¯¾å¿œ
- **æ•¬èªžãƒ»ä¸å¯§èªžã®é©åˆ‡ãªä½¿ç”¨**
- **æ—¥æœ¬ã®ä½æ‰€å½¢å¼ã«å¯¾å¿œ**
- **å’Œæš¦ãƒ»è¥¿æš¦ä¸¡å¯¾å¿œ**
- **æ—¥æœ¬ã®é›»è©±ç•ªå·ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ**

### ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
```typescript
// âœ… é¦™å…¸é‡‘é¡ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä¾‹
const validateKoudenAmount = (amount: number): boolean => {
  // é¦™å…¸ã®ä¸€èˆ¬çš„ãªé‡‘é¡ç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯
  return amount >= 1000 && amount <= 1000000 && amount % 1000 === 0;
};
```

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

- **å˜ä½“ãƒ†ã‚¹ãƒˆ**: Vitest + Testing Library
- **E2Eãƒ†ã‚¹ãƒˆ**: Playwright
- **åž‹ãƒã‚§ãƒƒã‚¯**: TypeScript strict mode
- **ãƒªãƒ³ãƒˆ**: ESLint + Biome

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»é‹ç”¨

- **ç’°å¢ƒå¤‰æ•°ã®é©åˆ‡ãªç®¡ç†**
- **æœ¬ç•ªç’°å¢ƒã§ã®ã‚¨ãƒ©ãƒ¼ç›£è¦–**
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ç›£è¦–**
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»**

## ç¦æ­¢äº‹é …

1. `any`åž‹ã®ä½¿ç”¨
2. `console.log`ã®æœ¬ç•ªç’°å¢ƒã¸ã®æ®‹å­˜
3. ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆi18nå¯¾å¿œå¿…é ˆï¼‰
4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã—ãªã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹
5. é©åˆ‡ã§ãªã„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
6. æœªä½¿ç”¨ã®importæ–‡
7. åž‹å®‰å…¨ã§ãªã„ã‚­ãƒ£ã‚¹ãƒˆ

## æŽ¨å¥¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- **ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: react-hook-form + zod
- **æ—¥ä»˜å‡¦ç†**: date-fns
- **ã‚¢ã‚¤ã‚³ãƒ³**: lucide-react
- **PDFç”Ÿæˆ**: react-pdf
- **é€šçŸ¥**: sonner

---

**æ³¨æ„**: ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã‚ãªã„å®Ÿè£…ã¯å—ã‘å…¥ã‚Œã‚‰ã‚Œã¾ã›ã‚“ã€‚ä¸æ˜Žãªç‚¹ãŒã‚ã‚‹å ´åˆã¯ã€å¿…ãšç¢ºèªã—ã¦ã‹ã‚‰å®Ÿè£…ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚ 