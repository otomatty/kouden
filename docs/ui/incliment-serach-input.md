# Input + インクリメンタルサーチ (ベータ版) コンポーネント仕様書

**コンポーネント名:** `Custom項目インクリメンタルサーチInput`

**概要:**

Input 欄を基本とし、インクリメンタルサーチによる候補表示と自由入力を組み合わせたカスタム項目入力コンポーネントです。登録済みの項目からの選択と、新しい項目の追加を柔軟に行えます。ベータ版機能として提供します。

**UI:**

* **ラベル:**  カスタム項目の名称を表示するラベル。
* **Input 欄:**  項目名を入力または選択するためのテキスト Input 欄。
    * **プレースホルダー:**  初期表示時に「項目名を入力 または 選択」のようなプレースホルダーテキストを表示。
    * **入力状態:**  ユーザーが文字を入力すると、インクリメンタルサーチが開始され、候補リストが表示されます。
* **ドロップダウン候補リスト:**  登録済みの項目から、Input 欄の入力内容に合致する候補をリスト表示します。
    * **候補項目:**  前方一致で検索された登録済み項目をリスト表示。
    * **スクロールバー:**  候補リストが一定件数を超える場合に表示。
    * **選択:**  候補項目をクリックまたはキーボード操作で選択できます。
* **「新しい項目を追加」ボタン (オプション):**  Input 欄の下に、必要に応じて「+ 新しい項目を追加」ボタンを配置 (UIの複雑さを考慮して最初は非表示でも良い)。

**機能:**

* **インクリメンタルサーチ:**  Input 欄への入力内容を監視し、リアルタイムで登録済み項目を検索します。
    * **検索ロジック:**  前方一致検索を基本とします。
    * **候補表示:**  検索結果をドロップダウンリストに表示します。
    * **候補件数:**  表示する候補件数を制限します (例: 最大5-10件)。
* **候補選択:**
    * **クリック選択:**  候補リストの項目をクリックすると、Input 欄に選択された項目名が入力され、候補リストが閉じます。
    * **キーボード選択:**  ↑↓キーで候補を選択し、Enterキーで確定できます。
* **自由入力:**  候補リストから選択せずに、Input 欄に自由に項目名を入力できます。
* **項目の登録と再利用:**  自由入力または候補選択で確定された項目名は、自動的に登録され、次回以降の入力時に候補として表示されます。
* **値の取得:**  確定された項目名 (選択または自由入力) をコンポーネント外部に通知します。

**入力 (Props):**

| Prop名                 | 型       | 説明                                                                 | 必須 | デフォルト値 |
| ---------------------- | -------- | -------------------------------------------------------------------- | --- | ----------- |
| `label`                | string   | カスタム項目のラベル                                                     | 必須 | -           |
| `initialOptions`       | array    | 初期表示用の候補リスト (例: `[{value: 'value1', label: 'ラベル1'}, ... ]`)  | 任意 | `[]`        |
| `fetchOptions`         | function | 非同期で候補リストを取得する関数 (例: APIリクエスト)                               | 任意 | `null`      |
| `value`                | string   | 初期入力値 (または v-model で双方向バインディング)                                 | 任意 | `''`        |
| `placeholder`          | string   | Input 欄のプレースホルダーテキスト                                          | 任意 | `項目名を入力 または 選択` |
| `debounceDelay`        | number   | インクリメンタルサーチの debounce 遅延時間 (ミリ秒)                               | 任意 | `300`       |
| `minSearchLength`      | number   | インクリメンタルサーチを開始する最小入力文字数                                   | 任意 | `1`         |
| `maxSuggestions`       | number   | ドロップダウン候補リストに表示する最大件数                                     | 任意 | `10`        |
| `disabled`             | boolean  | コンポーネントを disabled 状態にするか                                    | 任意 | `false`     |

**出力 (Emit):**

| イベント名    | 引数    | 説明                                                                   |
| ------------- | ------ | ---------------------------------------------------------------------- |
| `update:value` | string | 確定された項目名 (v-model 用)                                               |
| `change`      | string | 項目名が確定された際に、確定された項目名を通知                                     |
| `addNewOption` | string | 新しい項目が自由入力で追加された際に、追加された項目名を通知 (必要に応じて、登録処理を外部で行う場合に利用) |

**制約事項:**

* インクリメンタルサーチのパフォーマンスは、登録済み項目の数や検索ロジックに依存します。
* 候補リストの表示位置やスタイルは、UIデザインに合わせて調整が必要です。
* ベータ版機能として、ユーザーからのフィードバックを収集し、改善を重ねていく必要があります。

**備考:**

* 柔軟性と効率性を両立し、ユーザーの入力体験を向上させることを目指したコンポーネントです。
* ITリテラシーが高いユーザーにとっては、より効率的な入力手段となります。
* ベータ版として提供し、ユーザーの反応を見ながら正式版への移行を検討します。
* `fetchOptions` prop を使用することで、API 経由で動的に候補リストを取得する構成も可能です。

---

**設定画面での切り替えUI (例):**

設定画面でカスタム項目の入力方法を切り替えるUIとしては、以下のようなものが考えられます。

* **ラジオボタン:**
    ```
    カスタム項目の入力方法:
    <ラジオボタン> セレクトボックス (従来形式)
    <ラジオボタン> Input + インクリメンタルサーチ (ベータ版)
    ```

* **セレクトボックス:**
    ```
    カスタム項目の入力方法:
    <セレクトボックス>
      <option value="selectbox">セレクトボックス (従来形式)</option>
      <option value="incremental">Input + インクリメンタルサーチ (ベータ版)</option>
    </セレクトボックス>
    ```

これらの仕様書と切り替えUIを参考に、カスタム項目入力コンポーネントの実装を進めてください。ベータ版の Input + インクリメンタルサーチ コンポーネントについては、ユーザーからのフィードバックを積極的に収集し、改善していくことをお勧めします。