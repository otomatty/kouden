---
title: 一括操作機能
description: 複数の香典記録を効率的に処理するための一括操作機能について説明します
---

# 一括操作機能

## 一括操作の概要

一括操作機能を使用すると、複数の香典記録を同時に処理できます。
大量のデータを効率的に管理し、作業時間を大幅に短縮できます。

## 一括入力機能

### CSVファイルからのインポート

1. **CSVファイルの準備**
   - 指定された形式でCSVファイルを作成
   - 必須項目：金額、参列タイプ
   - 任意項目：名前、組織、住所、関係性など

2. **インポートの実行**
   - 「一括インポート」ボタンをクリック
   - CSVファイルを選択してアップロード
   - データの検証とプレビュー確認

3. **データの確認と保存**
   - インポート対象データを確認
   - エラーがある場合は修正
   - 「インポート実行」でデータを保存

### CSVファイルの形式

```csv
名前,組織,金額,参列タイプ,住所,電話番号,関係性,備考
山田太郎,ABC商事,10000,葬儀,東京都渋谷区...,03-1234-5678,会社関係,
田中花子,DEF病院,5000,弔問,東京都新宿区...,090-1234-5678,友人,看護師
```

## 一括編集機能

### 複数記録の同時編集

1. **対象記録の選択**
   - チェックボックスで複数記録を選択
   - 「すべて選択」で全記録を選択
   - フィルタ機能と組み合わせて対象を絞り込み

2. **一括編集の実行**
   - 「一括編集」ボタンをクリック
   - 編集したい項目を選択
   - 新しい値を入力

3. **変更の適用**
   - 変更内容をプレビューで確認
   - 「適用」ボタンで変更を実行

### 一括編集可能な項目

- **関係性**：選択した記録の関係性を一括変更
- **参列タイプ**：参列方法の一括修正
- **備考**：共通の備考情報を一括追加
- **住所の一部**：市区町村の変更など
- **返礼状況**：返礼完了フラグの一括更新

## 一括削除機能

### 安全な一括削除

1. **削除対象の選択**
   - 削除したい記録をチェックボックスで選択
   - 削除理由を確認

2. **削除の実行**
   - 「一括削除」ボタンをクリック
   - 削除確認ダイアログで内容を確認
   - 「削除する」で確定

3. **バックアップの自動作成**
   - 削除前に自動でバックアップ作成
   - 24時間以内であれば復元可能

## 一括エクスポート機能

### データの一括出力

1. **出力範囲の選択**
   - 全データまたは選択したデータ
   - フィルタ条件での絞り込み
   - 日付範囲での限定

2. **出力形式の選択**
   - CSV形式：表計算ソフトで利用
   - Excel形式：詳細な書式設定付き
   - PDF形式：印刷用レポート

3. **項目の選択**
   - 出力したい項目を選択
   - 項目の並び順を指定
   - カスタム項目の追加

## 一括検索・置換

### 文字列の一括置換

1. **検索条件の設定**
   - 検索対象の項目を選択
   - 検索文字列を入力
   - 正規表現の利用も可能

2. **置換内容の設定**
   - 置換後の文字列を入力
   - プレビューで結果を確認

3. **置換の実行**
   - 対象件数を確認
   - 「置換実行」で一括処理

### 活用例

- **組織名の統一**：「株式会社」と「㈱」の表記統一
- **住所の修正**：市町村合併による住所表記の更新
- **関係性の整理**：「会社」と「職場」の表記統一

## フィルタ機能との連携

### 条件指定での一括操作

1. **フィルタ条件の設定**
   - 金額範囲での絞り込み
   - 関係性での絞り込み
   - 日付範囲での絞り込み

2. **フィルタ結果に対する一括操作**
   - 絞り込まれたデータのみを対象
   - 一括編集、削除、エクスポートが可能

## エラーハンドリング

### 一括操作中のエラー対応

1. **バリデーションエラー**
   - 不正なデータ形式の検出
   - エラー行の表示と修正案内
   - 部分的な処理継続

2. **重複データの処理**
   - 重複データの自動検出
   - 統合または除外の選択
   - 重複レポートの生成

3. **処理中断時の対応**
   - 処理途中での中断機能
   - 部分的に処理されたデータの管理
   - ロールバック機能

## パフォーマンス最適化

### 大量データの効率的処理

1. **バッチ処理**
   - 一定件数ごとの分割処理
   - プログレスバーでの進捗表示
   - バックグラウンド処理

2. **並列処理**
   - 複数の処理を同時実行
   - システムリソースの効率利用

## 一括操作のベストプラクティス

### 安全な一括操作のために

1. **事前のバックアップ**
   - 重要な一括操作前はバックアップ作成
   - データのエクスポートでローカル保存

2. **段階的な実行**
   - 大量データは小分けして実行
   - テストデータでの事前確認

3. **権限の確認**
   - 一括操作に必要な権限の確認
   - 重要な操作は複数人での確認

### 効率的な作業のために

1. **テンプレートの活用**
   - CSVテンプレートの事前準備
   - よく使う検索条件の保存

2. **作業の自動化**
   - 定期的な一括処理のスケジュール設定
   - 条件に基づく自動実行

## よくある質問

### Q: 一括インポート時にエラーが発生した場合は？
A: エラー行のみスキップして他のデータをインポートできます。エラー内容は詳細レポートで確認できます。

### Q: 一括操作を元に戻すことはできますか？
A: 24時間以内であれば、バックアップから復元できます。重要な操作前は手動バックアップをお勧めします。

### Q: CSVインポートでの文字化けを防ぐには？
A: UTF-8形式で保存し、BOM付きにしてください。Excelの場合は「UTF-8 CSV」で保存してください。

### Q: 一括操作に時間がかかる場合は？
A: 大量データの場合はバックグラウンド処理になります。処理完了時にメール通知されます。

## 関連ページ

- [香典の記録方法](./recording-entries)
- [記録の編集・削除](./entry-management)
- [検索・絞り込み機能](./search-and-filter)
- [データのエクスポート](../statistics/pdf-export) 